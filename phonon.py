import numpy as np
import matplotlib.pyplot as plt
from matplotlib.gridspec import GridSpec
from QEData import *

nbnd = 24
path_kpoint_tik = [1,11,21,31,41,51,52,62]
path_kpoint_lables = ["Gamma","X","M","Gamma","R","X","M","R"]
kpoints = np.array([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62])
frequency_1 = np.array([-0.0000,17.7754,34.9903,51.1766,66.0277,79.4240,91.4009,102.0676,111.5103,119.7303,126.6115,127.3765,129.3724,131.9345,134.1930,135.4514,135.5419,134.9114,134.3772,134.7747,136.5388,130.6687,123.1777,113.8393,102.2536,88.6350,73.5431,57.2551,39.5721,20.3303,-0.0000,26.6252,50.0991,68.9851,83.5063,94.2856,101.7673,106.4461,108.9262,109.8864,109.6063,110.6546,112.3824,114.6527,117.0281,119.3097,121.4296,123.3854,125.0621,126.2100,126.6115,136.5388,135.9939,134.3841,131.7904,128.3665,124.3567,120.1050,116.0445,112.6573,110.3999,109.6063])
frequency_2 = np.array([-0.0000,17.7754,34.9903,51.1766,66.0277,79.4240,91.4009,102.0676,111.5103,119.7303,126.6115,127.4348,129.4409,132.0269,134.3258,135.6345,135.7732,135.1811,134.6769,135.1024,136.8946,140.8355,145.3723,147.0183,132.8795,114.0879,94.0656,72.5885,49.5357,25.1445,-0.0000,26.6252,50.0991,68.9851,83.5063,94.2856,101.7673,106.4461,108.9262,109.8864,109.6063,110.7996,112.5350,114.7936,117.1391,119.3791,121.5332,123.5294,125.1846,126.3000,126.6115,136.8946,136.3524,134.7506,132.1704,128.7655,124.7803,120.5583,116.5297,113.1701,110.9188,109.6063])
frequency_3 = np.array([0.0000,25.5930,50.8949,75.6885,99.8808,123.5099,141.4953,139.4760,136.4555,132.2261,126.7036,128.0169,132.0095,138.1696,145.8829,154.4861,160.4640,152.7301,145.8987,140.4534,136.8946,140.8815,150.4923,150.4588,147.3364,147.2412,141.6254,110.2557,75.9274,38.8285,0.0000,48.8087,96.3284,141.9993,143.4231,140.3623,135.5145,128.5232,120.1490,112.8575,110.0449,111.8477,117.9761,126.7443,136.5618,145.4756,150.8886,149.6184,141.1620,131.0595,126.7036,136.8946,136.3524,134.7506,132.1704,128.7655,124.7803,120.5583,116.5297,113.1701,110.9188,110.0449])
frequency_4 = np.array([143.9988,144.2323,144.1382,143.8974,143.4829,142.7518,141.4953,139.4760,136.4555,132.2261,126.7036,128.0733,132.0661,138.2236,145.9302,154.5217,160.8665,153.1463,146.3092,140.8416,137.2548,142.0031,150.5497,160.3119,165.5987,165.3748,147.2065,146.9420,146.0529,144.8006,143.9988,144.6380,145.3487,145.0799,143.4231,140.3623,135.5145,128.5232,120.1490,112.8575,110.0449,112.3033,118.5019,127.1704,136.9231,145.8169,151.2364,149.9276,141.3604,131.1632,126.7036,137.2548,136.7127,135.1115,132.5320,129.1277,125.1420,120.9175,116.8847,113.5220,111.2817,110.0449])
frequency_5 = np.array([143.9988,144.2323,144.1382,143.8974,143.4829,142.7518,146.7052,169.6111,192.3029,199.9079,201.1941,196.4779,190.7279,184.0480,176.5749,168.5809,163.3620,172.0022,180.0388,187.2537,193.3414,180.9813,166.5836,160.3650,165.6414,165.4422,161.4212,155.6981,149.7455,145.5113,143.9988,144.6380,145.3487,145.0799,144.0080,141.0147,136.2072,129.1786,120.7398,113.4386,110.0449,112.5122,118.8159,128.5380,140.0504,152.1700,164.1219,175.4000,185.5702,194.2653,201.1941,193.3414,190.9803,184.4583,174.8870,163.3875,150.9591,138.5584,127.1833,117.8985,111.7609,110.0449])
frequency_6 = np.array([143.9988,145.5842,150.1075,156.9448,165.2501,174.1220,182.7102,190.2651,196.1598,200.0445,201.3351,196.7110,190.9750,184.3249,176.8943,168.9449,163.3865,172.0098,180.0419,187.2609,193.3523,192.4008,189.6525,185.2568,179.3054,170.2783,161.5585,155.9253,150.0663,145.8390,143.9988,145.2002,145.8975,145.6304,185.5879,196.6143,186.2893,164.9082,139.5389,118.4624,110.4943,112.7395,119.3157,129.0409,140.5312,152.6104,164.5051,175.7193,185.8362,194.5022,201.3351,193.3523,191.0462,184.5882,175.0710,163.6142,151.2250,138.8678,127.5397,118.2973,112.1891,110.4943])
frequency_7 = np.array([144.7248,146.0106,150.4414,157.2177,165.4667,174.2919,182.8491,190.3912,196.2880,200.0445,201.3351,205.0980,207.9801,209.8807,210.7431,210.5162,209.1844,206.7748,203.3403,198.9303,193.7839,192.8314,190.0573,185.6133,179.6137,172.0025,163.9722,156.2590,150.1406,145.9984,144.7248,149.5027,163.5814,180.4154,193.4222,196.7477,186.2893,164.9109,139.6427,118.5991,110.4943,116.4409,132.6236,153.0026,172.8671,189.3225,200.9526,207.3071,208.7331,206.3179,201.3351,193.7839,191.4648,184.9989,175.4614,163.9689,151.5402,139.1555,127.8238,118.6033,112.5377,110.4943])
frequency_8 = np.array([144.7248,146.0106,150.4414,157.2177,165.4667,174.2919,182.8491,190.3912,196.2880,200.3689,201.6639,205.3362,208.2078,210.0819,210.9016,210.6240,209.2447,206.8004,203.3477,198.9332,193.7839,204.2512,212.5083,217.2122,196.3740,172.3011,164.3181,156.6695,150.4215,146.2295,144.7248,150.0359,164.0033,180.7005,193.6303,196.7477,186.2915,164.9109,139.6427,118.5991,110.4943,116.4965,132.6390,153.0217,172.8904,189.3455,201.0117,207.4418,208.9383,206.5539,201.6639,193.7839,191.4648,184.9989,175.4614,163.9689,151.5402,139.1555,127.8238,118.6033,112.5377,110.4943])
frequency_9 = np.array([144.7248,146.2854,150.7440,157.4994,165.7304,174.5525,183.1213,190.6831,196.5993,214.7281,236.5647,236.3925,236.0727,236.1558,237.3974,240.4684,245.6338,252.6465,260.9287,269.8320,278.4228,260.6533,241.1968,219.9432,217.0558,211.0640,199.0348,182.3005,164.2550,149.9367,144.7248,150.0359,164.0033,180.7005,193.6303,226.4828,264.0537,298.3759,329.7213,356.9377,371.8044,363.1523,344.8991,322.9138,299.4931,276.5036,256.4224,242.7155,237.0326,236.3102,236.5647,278.4228,280.7795,287.3652,297.1529,309.1110,322.3011,335.8160,348.7379,360.0723,368.4788,371.8044])
frequency_10 = np.array([402.3803,389.1649,375.3613,361.1557,346.4684,331.0711,314.6801,297.0626,278.1211,257.9271,236.8302,236.6559,236.3284,236.3957,237.6131,240.6566,245.7988,252.7960,261.0670,269.9581,278.6254,278.4376,279.2570,283.8181,294.6897,311.3996,331.1052,351.2427,370.3906,387.7539,402.3803,386.3832,365.9939,344.0706,324.5312,313.2247,315.3705,329.4581,348.5864,365.0761,371.8921,363.2354,344.9904,322.9897,299.5409,276.5473,256.5053,242.8660,237.2572,236.5698,236.8302,278.6254,280.9798,287.5697,297.3705,309.3345,322.5159,335.9657,348.8548,360.1823,368.5813,371.8921])
frequency_11 = np.array([402.3803,400.8278,396.4476,389.8994,381.9355,373.3553,364.9437,357.4336,351.4707,347.6213,346.2914,340.0797,333.9449,327.9627,322.0605,316.0697,309.7845,302.9953,295.5719,287.4870,279.2214,279.0507,279.6701,284.0335,294.7937,311.4615,331.1460,351.2663,370.4043,387.7695,402.3803,386.4069,365.9939,344.0706,324.5312,313.2247,315.3705,329.4971,348.6841,365.1553,371.8921,368.2449,358.5504,345.8700,334.1336,326.2741,323.2976,324.8557,330.0431,337.6317,346.2914,279.2214,281.5242,287.9820,297.6214,309.4420,322.5225,335.9657,348.8548,360.1823,368.5813,371.8921])
frequency_12 = np.array([402.3803,400.8278,396.4476,389.8994,381.9585,373.4008,364.9861,357.4495,351.4707,347.6213,346.2914,340.0829,333.9572,327.9730,322.0629,316.0725,309.7859,303.0127,295.6144,287.5572,279.2214,296.1520,312.5800,328.2503,343.2600,357.5573,369.9054,378.9671,390.0198,399.0052,402.3803,386.4069,366.0053,344.2197,324.9154,313.6751,315.5678,329.4971,348.6841,365.1553,371.8921,368.3029,358.6503,346.0307,334.3558,326.5237,323.5077,324.9733,330.0759,337.6321,346.2914,279.2214,281.5242,287.9820,297.6214,309.4420,322.5225,336.0135,348.9183,360.2342,368.6045,371.8921])
frequency_13 = np.array([402.4808,400.9399,396.5173,389.9187,381.9585,373.4008,364.9861,357.4495,351.4945,347.6804,346.3647,352.6202,358.8918,365.1232,371.3516,377.6472,384.0431,390.6200,397.3865,404.3285,411.3831,397.1820,384.0112,373.5397,367.0909,365.6832,370.8645,382.7635,392.7170,399.7929,402.4808,411.5201,413.2197,410.6374,407.2282,404.8624,403.7619,403.3460,403.1850,402.6578,401.9939,401.3880,399.1038,395.5633,390.9277,385.2764,378.7279,371.4560,363.5803,355.1502,346.3647,411.3831,411.4821,411.7341,412.0107,412.1161,411.8079,410.8324,408.9961,406.3238,403.4238,401.9939])
frequency_14 = np.array([402.5669,400.9992,396.5800,389.9837,382.0003,373.4173,365.0007,357.4837,351.5368,347.7160,346.3977,352.6595,358.9463,365.1765,371.3845,377.6483,384.0811,390.6866,397.4670,404.4086,411.4784,411.8666,412.9238,414.2911,415.8360,417.6306,419.4977,420.5342,419.0461,413.2021,402.5669,411.5870,413.2680,410.6374,407.2282,404.8624,403.7619,403.4778,403.4230,402.9452,402.3964,401.5987,399.3246,395.8031,391.1818,385.5252,378.9455,371.6229,363.6905,355.2081,346.3977,411.4784,411.5664,411.7916,412.0421,412.1429,411.8666,410.9599,409.2134,406.6295,403.7977,402.3964])
frequency_15 = np.array([402.5669,414.9812,426.4074,436.4820,445.1273,452.1848,452.8044,453.8317,455.4351,455.6568,455.7288,454.9134,454.4894,454.4790,453.4938,447.5671,440.7579,433.4825,426.0612,418.6832,411.4784,411.9019,412.9874,414.3875,415.9529,417.7462,419.5955,420.6122,419.1091,413.2491,402.5669,411.5870,413.2680,410.6765,407.3675,405.0096,403.7895,403.4778,403.4230,402.9452,402.3964,407.8040,417.4038,426.6369,434.9514,442.3956,449.1868,455.3509,454.8210,454.7377,455.7288,411.4784,411.5664,411.7916,412.0421,412.1429,411.8666,410.9599,409.2134,406.6295,403.7977,402.3964])
frequency_16 = np.array([448.8795,449.1834,449.9008,450.7743,451.5644,452.1848,452.8044,453.8317,455.4536,455.6911,455.7640,454.9748,454.5577,454.5556,453.5512,447.6261,440.8142,433.5357,426.1150,418.7434,411.5249,425.5590,439.0013,452.0817,452.4813,451.0627,449.9464,449.2247,448.9307,448.9122,448.8795,449.1402,449.7720,450.8666,452.7636,455.8708,460.4123,448.5653,431.2525,413.6460,402.3964,407.9598,417.5227,426.7523,435.0720,442.5082,449.2786,455.4184,454.9058,454.8032,455.7640,411.5249,411.6212,411.8666,412.1383,412.2492,411.9656,411.0350,409.2567,406.6460,403.8005,402.3964])
frequency_17 = np.array([448.8795,449.1834,449.9008,450.7743,451.5644,452.5047,454.4688,455.0471,455.4536,455.6911,455.7640,456.9926,458.6734,458.1587,454.8800,455.6594,456.7668,458.1361,459.7080,461.4414,463.3104,459.6875,456.6096,454.2571,460.8739,457.2249,454.7322,452.7512,450.9486,449.4990,448.8795,449.1402,449.7720,450.8666,452.7636,455.8708,460.4123,466.2133,472.3612,477.1838,478.8841,477.6528,474.2281,469.9064,465.6150,461.7674,458.5346,456.1330,459.9995,457.5833,455.7640,463.3104,463.6789,464.7542,466.4379,468.5770,470.9729,473.3931,475.5958,477.3561,478.4918,478.8841])
frequency_18 = np.array([448.8795,449.2640,450.2444,451.4711,452.6628,453.6765,454.5052,455.0858,455.5450,455.7741,455.8488,457.0566,458.7430,458.2114,454.9639,455.7456,456.8530,458.2222,459.7967,461.5352,463.3104,463.3834,463.3441,462.7307,461.0526,457.4007,454.8766,452.8566,451.0302,449.5806,448.8795,449.2530,449.9309,451.1624,453.2041,456.3467,460.8029,466.2133,472.3612,477.1838,478.8841,477.7607,474.3418,470.0365,465.7587,461.9130,458.6677,456.2390,460.1135,457.6508,455.8488,463.3104,463.6789,464.7542,466.4458,468.6051,471.0330,473.4950,475.7434,477.5452,478.6977,478.8841])
frequency_19 = np.array([449.0269,449.3682,450.3124,451.5209,452.7029,453.7128,454.5052,455.0858,455.8096,459.0926,463.8010,463.2126,461.3785,460.8136,463.4052,466.3692,469.5294,469.6438,467.4257,465.3120,463.3169,463.4783,463.3981,462.7413,461.3770,459.5039,457.2854,454.6495,451.8056,449.6559,449.0269,450.7428,455.4281,460.8265,465.7024,469.8020,464.0545,466.4759,472.5162,477.2746,479.0899,478.5088,477.3798,475.5093,472.8420,469.6152,466.2275,462.9655,460.2281,462.9848,463.8010,463.3169,463.6847,464.7564,466.4458,468.6051,471.0330,473.4950,475.7434,477.5452,478.7094,479.0899])
frequency_20 = np.array([449.0269,449.3682,450.3124,451.5209,452.7029,453.7128,454.5634,455.1483,455.8096,459.0926,463.8010,463.2556,461.4270,460.8910,463.4820,466.4387,469.5848,469.7663,467.5474,465.4295,463.5285,467.3968,471.7940,465.9765,461.3911,459.5259,457.2956,454.6608,451.8429,449.7222,449.0269,450.8332,455.4671,460.8265,465.7024,469.8020,473.0889,475.6430,477.5116,478.6423,479.0899,478.7112,477.5502,475.5844,472.8584,469.6757,466.3084,463.0493,460.2961,463.0262,463.8010,463.5285,463.8962,464.9673,466.6480,468.7861,471.1811,473.6004,475.8025,477.5624,478.7094,479.0899])
frequency_21 = np.array([449.0269,449.4056,450.3722,451.5830,452.7622,453.7698,458.9946,465.0909,471.2391,469.6442,463.8450,464.1523,465.1804,466.8196,468.9422,471.3541,471.9632,472.6205,475.3273,477.3491,478.4266,476.5716,471.7948,466.1323,464.9528,467.2819,463.2207,458.7158,454.1988,450.4892,449.0269,450.8332,455.4671,460.8391,465.7553,469.8739,473.0889,475.6430,477.5116,478.6423,479.0899,478.7212,477.5825,475.7507,473.4973,471.0490,468.6668,466.6077,465.0596,464.1159,463.8450,478.4266,478.3676,478.2136,478.0190,477.8565,477.8002,477.9005,478.1545,478.4878,478.7722,479.0899])
frequency_22 = np.array([485.6004,486.0786,487.2811,488.5917,489.2174,488.4451,485.8659,481.5062,475.8351,469.6442,463.8450,464.1892,465.2063,466.8308,468.9450,471.3666,472.0854,472.6600,475.3503,477.3603,478.4374,476.6546,471.9227,473.3108,470.6551,476.6948,485.4047,489.4890,488.7074,486.5382,485.6004,487.0427,489.4308,489.2925,484.9207,476.3864,473.1508,475.6775,477.5472,478.7202,479.1199,478.7418,477.6013,475.7628,473.5091,471.0681,468.6981,466.6490,465.1045,464.1604,463.8450,478.4374,478.3845,478.2407,478.0568,477.9089,477.8771,478.0137,478.3107,478.6846,478.9877,479.1199])
frequency_23 = np.array([485.6004,486.0786,487.2811,488.5917,489.2174,488.4451,485.8659,481.5062,475.8351,477.6637,484.1923,483.5805,481.8988,479.5417,476.9489,474.3959,473.8158,476.0323,477.7029,478.5697,478.5017,477.1010,475.4051,476.9771,483.0391,489.0855,490.8901,490.6115,489.1756,486.8503,485.6004,487.6847,491.2388,491.9518,489.2364,485.7352,483.2866,481.6356,480.2720,479.3580,479.1199,479.0768,479.1896,479.1895,478.9624,478.6001,478.4398,478.9939,480.7043,483.0500,484.1923,478.5017,478.4552,478.3311,478.1732,478.0444,478.0119,478.1236,478.3785,478.7075,478.9877,479.1199])
frequency_24 = np.array([485.6004,486.7015,489.6871,493.7056,497.6311,500.3757,501.1518,499.6229,495.9246,490.5682,484.3202,483.7077,482.0237,479.6633,477.0682,474.5155,473.8321,476.0470,477.7129,478.5753,478.5017,479.6429,481.0545,483.2278,486.2012,489.1684,493.2323,493.8554,491.1116,487.3350,485.6004,487.6847,491.2388,491.9518,489.2364,485.7352,483.2866,481.6356,480.2720,479.3580,479.1199,479.1673,479.2969,479.3104,479.0880,478.7149,478.5365,479.0881,480.8167,483.1756,484.3202,478.5017,478.4552,478.3311,478.1732,478.0444,478.0119,478.1236,478.3785,478.7075,478.9977,479.1199])


fig = plt.figure()
gs = GridSpec(1, len(path_kpoint_tik)+1)
plt.suptitle(r'$\vec{k}$-point and Density of State Vibrational Frequency Bands for ' + structure_names[0] + ' ' + chemical_formula)

ax1 = fig.add_subplot(gs[0,0:len(path_kpoint_tik)])
for i in range(nbnd):
    exec(f'ax1.plot(kpoints, frequency_{i+1})')
ax1.set_xticks(path_kpoint_tik)
ax1.set_xticklabels(path_kpoint_lables)
ax1.set_xlim(kpoints[0],kpoints[-1])
ax1.set_ylabel(r'Frequency (Hz)')
ax1.set_xlabel(r'$\vec{k}$ points')

ax2 = fig.add_subplot(gs[0,len(path_kpoint_tik):], sharey = ax1)
ax2.tick_params(labelleft=False)
ax2.set_xlabel(r'Density of State')
plt.subplots_adjust(wspace=0.25)


plt.show()
